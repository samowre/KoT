map3 [S1, S2, T: TYPE ]
		: THEORY

  BEGIN


    kk, kk1: VAR list[S1]
    ll, ll1: VAR list[S2]
    x: VAR S1
    y: VAR S2
    

    map3(f : [S1, S2 -> T],  kk, ll): RECURSIVE list[T] =
     CASES kk OF
      null: null,
      cons(x, kk1):  CASES ll OF
                       null: null
		       cons(y, ll1): cons(f(x, y),
		                          map3(f, kk1, ll1))
                     ENDCASES
     ENDCASES
     MEASURE length(kk)

     reduce3(a: T, f: [S1, S2, T -> T], kk, ll): RECURSIVE T = 
     CASES kk OF
      null: a, 
      cons(x, kk1): CASES ll OF
                     null: a
                     cons(y, ll1):
		       f(x, y, reduce3(a, f, kk1, ll1))
                    ENDCASES
     ENDCASES
     MEASURE length(kk)


  END map3
